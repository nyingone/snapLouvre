{% extends 'base.html.twig' %}

{% block title %}synthesis{% endblock %}

{% block body %}
    {% include 'inc/_workflow.html.twig' with {'level': '3'} only %}

    <div class="row">
        <div class="col-md-12" id="cart">
            <h3>{% trans %}Mail address required to receive ticket(s) following payment{% endtrans %} </h3>

            {{ form_start(form) }}

            {{ form_row(form) }}
            <quote>« la validation de votre commande vaut acceptation des conditions qui s’y réfèrent »</quote>
            {{ form_rest(form) }}

            <input type="submit" class="btn btn-primary" value="{% trans %} Payment {% endtrans %} "/>

            <ul>
                <li><a href="#fragment-1">Guests</a></li>
            </ul>

            {{ form_end(form) }}

            <div id="fragment-1">
                <h3>{{ bookingOrder.wishes }}  {% trans %}visitor(s) expected on{% endtrans %}  {{ bookingOrder.expectedDate | date("d/m/Y") }}  </h3>

                {% if bookingOrder.visitors is defined %}
                    {% include 'inc/_visitor.html.twig' with {'level': '3'} %}
                {% else %}
                    <p>{% trans %}no visitor found{% endtrans %}</p>
                {% endif %}
            </div>


        </div>
    </div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}

    {% if stripeSession is defined %}

      {# <script type="text/javascript" src=" {{ asset('js/payment_stripe.js') }}  "></script> #}
        <script>
            alert('kop');
            // Create a Stripe client.
            var stripe = Stripe('{{ stripe_public_key }}');

            // var stripe = Stripe('pk_test_sAuma2qLuGqShxLMk7Fr233r00EcyNcBe9');

            stripe.redirectToCheckout({
                // Make the id field from the Checkout Session creation API response
                // available to this file, so you can provide it as parameter here
                // instead of the {#{{CHECKOUT_SESSION_ID}}#} placeholder.
                sessionId: '{{ stripeSession.id }}'
            }).then(function (result) {
                // If `redirectToCheckout` fails due to a browser or network
                // error, display the localized error message to your customer
                // using `result.error.message`.
                console.log(result);
            });
        </script>
    {% endif %}

{% endblock %}

